import{S as t,z as N,J as w,a0 as C,_ as a,b as i}from"./index-Di1jv5f6.js";import{m as k}from"./Textarea-gaIhsF-Z-OB2gT--i.js";const E=()=>{const[n,f]=t.useState(""),[s,d]=t.useState(null),[c,m]=t.useState(null),[h,g]=t.useState(!1),[x,p]=t.useState(null),{navigateTo:u}=N(),{addToast:l}=w(),j=t.useCallback(async()=>{if(!n.trim()){l({type:"warning",message:"Por favor, forneça uma descrição para a campanha."});return}g(!0),p(null),d(null),m(null);try{const{campaign:e,videoUrl:r}=await C(n);d(e),m(r),l({type:"success",title:"Sucesso!",message:`Campanha "${e.name}" criada e salva com sucesso!`})}catch(e){console.error("Error building campaign:",e);const r=`Falha ao criar campanha: ${e instanceof Error?e.message:String(e)}`;p(r),l({type:"error",title:"Erro na Criação",message:r})}finally{g(!1)}},[n,l]),v=t.useCallback(()=>{if(!s){l({type:"warning",message:"Nenhum material de campanha para baixar."});return}const e=JSON.stringify(s,null,2),r=new Blob([e],{type:"application/json"}),b=URL.createObjectURL(r),o=document.createElement("a");o.href=b,o.download=`vitrinex-campaign-${s.name.replace(/\s/g,"-")}-${Date.now()}.json`,document.body.appendChild(o),o.click(),document.body.removeChild(o),URL.revokeObjectURL(b),l({type:"info",message:"Download dos materiais iniciado."})},[s,l]),y=t.useCallback(()=>{s?(u("SmartScheduler"),l({type:"info",message:`Navegando para o calendário para agendar a campanha "${s.name}".`})):l({type:"warning",message:"Nenhuma campanha gerada para adicionar ao calendário."})},[s,u,l]);return a.jsxs("div",{className:"container mx-auto py-8 lg:py-10",children:[a.jsx("h2",{className:"text-3xl font-bold text-textdark mb-8",children:"Construtor de Campanhas"}),x&&a.jsxs("div",{className:"bg-red-900 border border-red-600 text-red-300 px-4 py-3 rounded relative mb-8",role:"alert",children:[a.jsx("strong",{className:"font-bold",children:"Erro!"}),a.jsxs("span",{className:"block sm:inline",children:[" ",x]})]}),a.jsxs("div",{className:"bg-lightbg p-6 rounded-lg shadow-sm border border-gray-800 mb-8",children:[a.jsx("h3",{className:"text-xl font-semibold text-textlight mb-5",children:"Descreva sua Campanha"}),a.jsx(k,{id:"campaignPrompt",label:"Qual campanha você gostaria de criar? Seja o mais detalhado possível:",value:n,onChange:e=>f(e.target.value),rows:6,placeholder:"Ex: 'Uma campanha de lançamento para um novo curso online de fotografia avançada, visando fotógrafos amadores que querem profissionalizar seus trabalhos, duração de 2 semanas, com foco em Instagram e Facebook.'"}),a.jsx(i,{onClick:j,isLoading:h,variant:"primary",className:"w-full md:w-auto mt-4",children:h?"Criando Campanha...":"Criar Campanha"})]}),s&&a.jsxs("div",{className:"bg-lightbg p-6 rounded-lg shadow-sm border border-gray-800",children:[a.jsxs("h3",{className:"text-xl font-semibold text-textlight mb-5",children:["Campanha Gerada: ",s.name]}),a.jsxs("p",{className:"text-textlight mb-6",children:[a.jsx("span",{className:"font-semibold",children:"Cronograma:"})," ",s.timeline]}),a.jsxs("div",{className:"grid grid-cols-1 md:grid-cols-2 gap-8 mb-8",children:[a.jsxs("div",{children:[a.jsxs("h4",{className:"text-lg font-semibold text-textlight mb-4",children:["Posts (",s.posts.length,")"]}),a.jsx("ul",{className:"list-disc list-inside text-textlight space-y-3 max-h-64 overflow-y-auto bg-darkbg p-4 rounded-md border border-gray-700",children:s.posts.map((e,r)=>a.jsxs("li",{className:"text-sm",children:[a.jsxs("strong",{children:["Post ",r+1,":"]})," ",e.content_text.substring(0,100),"..."]},e.id||r))})]}),a.jsxs("div",{children:[a.jsxs("h4",{className:"text-lg font-semibold text-textlight mb-4",children:["Anúncios (",s.ads.length,")"]}),a.jsx("ul",{className:"list-disc list-inside text-textlight space-y-3 max-h-64 overflow-y-auto bg-darkbg p-4 rounded-md border border-gray-700",children:s.ads.map((e,r)=>a.jsxs("li",{className:"text-sm",children:[a.jsxs("strong",{children:["Ad ",r+1," (",e.platform,"):"]}),' "',e.headline,'" - ',e.copy.substring(0,70),"..."]},e.id||r))})]})]}),c&&a.jsxs("div",{className:"mb-8",children:[a.jsx("h4",{className:"text-lg font-semibold text-textlight mb-4",children:"Vídeo da Campanha"}),a.jsx("div",{className:"relative w-full aspect-video bg-gray-900 rounded-md overflow-hidden border border-gray-700",children:a.jsx("video",{controls:!0,src:c,className:"w-full h-full object-contain"})})]}),a.jsxs("div",{className:"flex flex-col sm:flex-row gap-3",children:[a.jsx(i,{onClick:v,variant:"primary",className:"w-full sm:w-auto",children:"Baixar Materiais"}),a.jsx(i,{onClick:y,variant:"secondary",className:"w-full sm:w-auto",children:"Adicionar ao Calendário"})]})]})]})};export{E as default};
