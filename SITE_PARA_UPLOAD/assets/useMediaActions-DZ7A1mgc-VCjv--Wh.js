import{S as d,J as u,$ as w}from"./index-Di1jv5f6.js";const g=async(n,t,e)=>{console.log(`Simulating upload of file: ${n.name} for user ${t}, type: ${e}`),await new Promise(r=>setTimeout(r,w));const o=`https://picsum.photos/400/300?random=${Date.now()}`;if(e==="audio"){const r=`https://www.soundhelix.com/examples/mp3/SoundHelix-Song-1.mp3?random=${Date.now()}`;return{id:`lib-${Date.now()}`,userId:t,type:e,file_url:r,thumbnail_url:void 0,tags:[],name:n.name,createdAt:new Date().toISOString()}}const a={id:`lib-${Date.now()}`,userId:t,type:e,file_url:o,thumbnail_url:e==="image"||e==="video"?o:void 0,tags:[],name:n.name,createdAt:new Date().toISOString()};return console.log("File uploaded (mock):",a),a};async function s(n){return await(await fetch(n)).blob()}function m(n){return new Promise((t,e)=>{const o=new FileReader;o.onloadend=()=>t(o.result),o.onerror=e,o.readAsDataURL(n)})}async function p(n,t){try{let e=t;if(/\.[^/.]+$/.test(e)||(e=`${e}.png`),window.electronAPI){const i=await s(n),c=await m(i),l=await window.electronAPI.saveFile(c,e);if(!l.success)throw new Error(l.error||"Cancelado pelo usuário");return!0}const o=await s(n),a=window.URL.createObjectURL(o),r=document.createElement("a");return r.href=a,r.download=e,document.body.appendChild(r),r.click(),document.body.removeChild(r),window.URL.revokeObjectURL(a),!0}catch(e){return console.error("Erro no download:",e),!1}}async function f(n,t,e){try{const o=await s(n),a=new File([o],"image.png",{type:"image/png"});return navigator.canShare&&navigator.canShare({files:[a]})?(await navigator.share({title:t,text:e,files:[a]}),!0):(console.warn("Compartilhamento de arquivos não suportado neste navegador."),!1)}catch(o){return console.error("Erro ao compartilhar:",o),!1}}const y=()=>{const[n,t]=d.useState(!1),{addToast:e}=u(),o=async(a,r)=>{if(!a)return;t(!0),e({type:"info",message:"Iniciando download..."});const i=await p(a,r);t(!1),i||e({type:"error",message:"Falha no download."})};return{handleDownload:o,handleShare:async(a,r,i)=>{a&&(t(!0),await f(a,r,i)||(e({type:"info",title:"Compartilhamento Indisponível",message:"Iniciando download como alternativa."}),await o(a,r)),t(!1))},isProcessing:n}};export{p as f,y as g,g as p};
