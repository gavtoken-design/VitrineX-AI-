import{h as i,O as K,x as L,ax as T,w as U,q as e,ay as D,az as B,C as x,aA as O,aB as G,aC as z,Q as M,aD as V,aE as H,aF as Q,aG as q,a3 as J,aH as W,aI as Y,E as C,aJ as X}from"./index-2IpbhVEU.js";import{I}from"./Input-CRT_4c0B.js";import{T as k}from"./Textarea-gaIhsF-Z.js";const se=()=>{const[r,l]=i.useState(K),[E,g]=i.useState(!0),[P,p]=i.useState(!1),[t,b]=i.useState(""),[v,h]=i.useState(!1),[y,u]=i.useState(!1),[o,n]=i.useState(null),{addToast:s}=L(),{theme:w,toggleTheme:j}=T(),{language:N,setLanguage:S}=U(),f="mock-user-123";i.useEffect(()=>{(async()=>{g(!0);try{const d=await W(f);d&&l(d.businessProfile);const c=localStorage.getItem("vitrinex_gemini_api_key");c&&(b(c),h(!0))}catch{s({type:"error",message:"Falha ao carregar dados iniciais."})}finally{g(!1)}})()},[f,s]);const A=a=>{if(b(a),!a.trim()){n(null);return}a.startsWith("AIzaSy")?a.length<38?n("Chave muito curta."):/\s/.test(a)?n("A chave não pode conter espaços."):n(null):n('Formato inválido. A chave deve começar com "AIzaSy".')},R=async()=>{if(o||!t.trim()){s({type:"warning",message:"Por favor, insira uma chave de API válida."});return}u(!0);try{await C(t.trim()),localStorage.setItem("vitrinex_gemini_api_key",t.trim()),h(!0),s({type:"success",title:"Chave Salva!",message:"O motor de IA foi ativado com sucesso."})}catch(a){s({type:"error",title:"Chave Inválida",message:`A conexão falhou: ${a.message}`}),h(!1)}finally{u(!1)}},F=async()=>{if(!t.trim()){s({type:"warning",message:"Por favor, insira uma chave de API para testar."});return}u(!0);try{const a=await C(t.trim());s({type:"success",title:"Conexão bem-sucedida!",message:`Resposta da IA: "${a.substring(0,50)}..."`})}catch(a){s({type:"error",title:"Falha na Conexão",message:a.message})}finally{u(!1)}},$=async()=>{p(!0);try{await X(f,{businessProfile:r}),s({type:"success",message:"Perfil do negócio salvo com sucesso!"})}catch(a){s({type:"error",message:`Falha ao salvar perfil: ${a instanceof Error?a.message:String(a)}`})}finally{p(!1)}},_=()=>{const a=localStorage.getItem("vitrinex_gemini_api_key")||t;if(!a){s({type:"warning",message:"Nenhuma chave salva para exportar."});return}const d=new Blob([a],{type:"text/plain"}),c=URL.createObjectURL(d),m=document.createElement("a");m.href=c,m.download="vitrinex_gemini_api_key.txt",document.body.appendChild(m),m.click(),document.body.removeChild(m),URL.revokeObjectURL(c),s({type:"info",message:"Backup da chave iniciado."})};return e.jsxs("div",{className:"animate-fade-in duration-500 space-y-10 max-w-3xl mx-auto pb-10",children:[e.jsx("h2",{className:"text-3xl font-bold text-title",children:"Configurações"}),e.jsxs("div",{className:"bg-surface p-8 rounded-xl shadow-card border border-border",children:[e.jsxs("h3",{className:"text-xl font-semibold text-title mb-6 flex items-center gap-2",children:[e.jsx(D,{className:"w-5 h-5 text-primary"})," Motor de Inteligência (Gemini)"]}),e.jsxs("div",{className:"space-y-4",children:[e.jsxs("div",{children:[e.jsx("label",{htmlFor:"apiKey",className:"block text-sm font-medium text-title mb-1.5",children:"Chave API"}),e.jsx("input",{id:"apiKey",type:"password",value:t,onChange:a=>A(a.target.value),placeholder:"AIzaSy...",className:`block w-full px-3 py-2.5 bg-surface border rounded-lg shadow-sm text-body placeholder-muted transition-colors sm:text-sm focus:outline-none ${o?"border-error ring-1 ring-error":"border-border focus:border-primary focus:ring-1 focus:ring-primary"}`}),o&&e.jsx("p",{className:"mt-2 text-xs text-error",children:o})]}),e.jsxs("div",{className:"bg-blue-50 dark:bg-blue-900/20 p-4 rounded-lg border border-blue-200 dark:border-blue-800 flex items-start gap-3",children:[e.jsx(B,{className:"w-5 h-5 text-blue-600 dark:text-blue-400 flex-shrink-0 mt-0.5"}),e.jsxs("p",{className:"text-xs text-blue-700 dark:text-blue-300",children:["Recursos avançados como ",e.jsx("strong",{children:"Geração de Vídeo (Veo)"})," e ",e.jsx("strong",{children:"Imagens de Alta Qualidade"})," exigem uma chave de API de um projeto Google Cloud com o faturamento ativo."]})]}),e.jsxs("div",{className:"flex flex-col sm:flex-row gap-3 mt-6",children:[e.jsxs(x,{onClick:R,isLoading:y&&!o,disabled:!!o||!t.trim(),variant:"primary",className:"w-full sm:w-auto",children:[e.jsx(O,{className:"w-4 h-4 mr-2"}),v?"Salvar & Reativar":"Salvar & Ativar"]}),e.jsx(x,{onClick:F,isLoading:y,disabled:!t.trim(),variant:"secondary",className:"w-full sm:w-auto",children:"Testar Conexão"}),e.jsxs(x,{onClick:_,variant:"ghost",className:"w-full sm:w-auto sm:ml-auto",disabled:!v&&!t,children:[e.jsx(G,{className:"w-4 h-4 mr-2"}),"Exportar Chave"]})]})]})]}),e.jsxs("div",{className:"bg-surface p-8 rounded-xl shadow-card border border-border",children:[e.jsxs("h3",{className:"text-xl font-semibold text-title mb-6 flex items-center gap-2",children:[e.jsx(z,{className:"w-5 h-5 text-primary"})," Perfil do Negócio"]}),E?e.jsx(M,{}):e.jsxs("div",{className:"space-y-4",children:[e.jsx(I,{id:"businessName",label:"Nome da Empresa",value:r.name,onChange:a=>l({...r,name:a.target.value})}),e.jsx(k,{id:"industry",label:"Indústria / Nicho",value:r.industry,onChange:a=>l({...r,industry:a.target.value}),rows:2,placeholder:"Ex: E-commerce de moda sustentável"}),e.jsx(k,{id:"targetAudience",label:"Público-alvo",value:r.targetAudience,onChange:a=>l({...r,targetAudience:a.target.value}),rows:3,placeholder:"Ex: Mulheres de 25-40 anos, conscientes ambientalmente..."}),e.jsx(I,{id:"visualStyle",label:"Estilo Visual",value:r.visualStyle,onChange:a=>l({...r,visualStyle:a.target.value}),placeholder:"Ex: Minimalista, vibrante, retrô..."}),e.jsx(x,{onClick:$,isLoading:P,variant:"primary",className:"w-full sm:w-auto",children:"Salvar Perfil"})]})]}),e.jsxs("div",{className:"bg-surface p-8 rounded-xl shadow-card border border-border",children:[e.jsxs("h3",{className:"text-xl font-semibold text-title mb-6 flex items-center gap-2",children:[e.jsx(V,{className:"w-5 h-5 text-primary"})," Preferências do Sistema"]}),e.jsxs("div",{className:"space-y-6",children:[e.jsxs("div",{children:[e.jsxs("label",{className:"block text-sm font-medium text-title mb-2 flex items-center gap-2",children:[e.jsx(H,{className:"w-4 h-4"})," Tema da Interface"]}),e.jsxs("div",{className:"flex gap-2 rounded-lg bg-background p-1 border border-border w-fit",children:[e.jsxs("button",{onClick:()=>j(),className:`px-4 py-1.5 text-sm font-medium rounded-md transition-colors ${w==="light"?"bg-white text-title shadow-sm":"text-muted hover:text-title"}`,children:[e.jsx(Q,{className:"w-4 h-4 inline mr-1.5"})," Claro"]}),e.jsxs("button",{onClick:()=>j(),className:`px-4 py-1.5 text-sm font-medium rounded-md transition-colors ${w==="dark"?"bg-slate-700 text-white shadow-sm":"text-muted hover:text-title"}`,children:[e.jsx(q,{className:"w-4 h-4 inline mr-1.5"})," Escuro"]})]})]}),e.jsxs("div",{children:[e.jsxs("label",{className:"block text-sm font-medium text-title mb-2 flex items-center gap-2",children:[e.jsx(J,{className:"w-4 h-4"})," Idioma"]}),e.jsxs("div",{className:"flex gap-2 rounded-lg bg-background p-1 border border-border w-fit",children:[e.jsx("button",{onClick:()=>S("pt-BR"),className:`px-4 py-1.5 text-sm font-medium rounded-md transition-colors ${N==="pt-BR"?"bg-white text-title shadow-sm":"text-muted hover:text-title"}`,children:"Português"}),e.jsx("button",{onClick:()=>S("en-US"),className:`px-4 py-1.5 text-sm font-medium rounded-md transition-colors ${N==="en-US"?"bg-white text-title shadow-sm":"text-muted hover:text-title"}`,children:"English"})]})]})]})]})]})};export{se as default};
